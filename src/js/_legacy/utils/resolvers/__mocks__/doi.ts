const data: { [k: string]: any } = {
    '10.1097/TA.0000000000001549': {
        indexed: {
            'date-parts': [[2017, 7, 25]],
            'date-time': '2017-07-25T12:23:21Z',
            timestamp: 1500985401112,
        },
        'reference-count': 43,
        publisher: 'Ovid Technologies (Wolters Kluwer Health)',
        issue: '2',
        'content-domain': { domain: [], 'crossmark-restriction': false },
        'published-print': { 'date-parts': [[2017, 8]] },
        DOI: '10.1097/ta.0000000000001549',
        type: 'article-journal',
        created: {
            'date-parts': [[2017, 5, 6]],
            'date-time': '2017-05-06T18:33:06Z',
            timestamp: 1494095586000,
        },
        page: '211-217',
        source: 'Crossref',
        'is-referenced-by-count': 1,
        title:
            'High ratio plasma resuscitation does not improve survival in pediatric trauma patients',
        prefix: '10.1097',
        volume: '83',
        author: [
            { given: 'Jeremy W.', family: 'Cannon', affiliation: [] },
            { given: 'Michael A.', family: 'Johnson', affiliation: [] },
            { given: 'Robert C.', family: 'Caskey', affiliation: [] },
            { given: 'Matthew A.', family: 'Borgman', affiliation: [] },
            { given: 'Lucas P.', family: 'Neff', affiliation: [] },
        ],
        member: '276',
        'container-title': 'Journal of Trauma and Acute Care Surgery',
        'original-title': [],
        deposited: {
            'date-parts': [[2017, 7, 21]],
            'date-time': '2017-07-21T22:59:03Z',
            timestamp: 1500677943000,
        },
        score: 1.0,
        subtitle: [''],
        'short-title': [],
        issued: { 'date-parts': [[2017, 8]] },
        'references-count': 43,
        URL: 'http://doi.org/10.1097/TA.0000000000001549',
        relation: {},
        ISSN: ['2163-0755'],
        subject: ['Surgery', 'Critical Care and Intensive Care Medicine'],
        'container-title-short': 'Journal of Trauma and Acute Care Surgery',
    },
    '10.1097/TA.0000000000001546': {
        indexed: {
            'date-parts': [[2017, 7, 25]],
            'date-time': '2017-07-25T14:19:24Z',
            timestamp: 1500992364284,
        },
        'reference-count': 34,
        publisher: 'Ovid Technologies (Wolters Kluwer Health)',
        issue: '2',
        'content-domain': { domain: [], 'crossmark-restriction': false },
        'published-print': { 'date-parts': [[2017, 8]] },
        DOI: '10.1097/ta.0000000000001546',
        type: 'article-journal',
        created: {
            'date-parts': [[2017, 6, 6]],
            'date-time': '2017-06-06T17:11:27Z',
            timestamp: 1496769087000,
        },
        page: '218-224',
        source: 'Crossref',
        'is-referenced-by-count': 0,
        title:
            'Focused assessment with sonography for trauma in children after blunt abdominal trauma',
        prefix: '10.1097',
        volume: '83',
        author: [
            { given: 'Bennett W.', family: 'Calder', affiliation: [] },
            { given: 'Adam M.', family: 'Vogel', affiliation: [] },
            { given: 'Jingwen', family: 'Zhang', affiliation: [] },
            { given: 'Patrick D.', family: 'Mauldin', affiliation: [] },
            { given: 'Eunice Y.', family: 'Huang', affiliation: [] },
            { given: 'Kate B.', family: 'Savoie', affiliation: [] },
            { given: 'Matthew T.', family: 'Santore', affiliation: [] },
            { given: 'KuoJen', family: 'Tsao', affiliation: [] },
            { given: 'Tiffany G.', family: 'Ostovar-Kermani', affiliation: [] },
            { given: 'Richard A.', family: 'Falcone', affiliation: [] },
            { given: 'M. Sidney', family: 'Dassinger', affiliation: [] },
            { given: 'John', family: 'Recicar', affiliation: [] },
            { given: 'Jeffrey H.', family: 'Haynes', affiliation: [] },
            { given: 'Martin L.', family: 'Blakely', affiliation: [] },
            { given: 'Robert T.', family: 'Russell', affiliation: [] },
            { given: 'Bindi J.', family: 'Naik-Mathuria', affiliation: [] },
            { given: 'Shawn D.', family: 'St Peter', affiliation: [] },
            { given: 'David P.', family: 'Mooney', affiliation: [] },
            { given: 'Chinwendu', family: 'Onwubiko', affiliation: [] },
            { given: 'Jeffrey S.', family: 'Upperman', affiliation: [] },
            { given: 'Jessica A.', family: 'Zagory', affiliation: [] },
            { given: 'Christian J.', family: 'Streck', affiliation: [] },
        ],
        member: '276',
        'container-title': 'Journal of Trauma and Acute Care Surgery',
        'original-title': [],
        deposited: {
            'date-parts': [[2017, 7, 21]],
            'date-time': '2017-07-21T22:59:10Z',
            timestamp: 1500677950000,
        },
        score: 1.0,
        subtitle: [' A multi-institutional analysis'],
        'short-title': [],
        issued: { 'date-parts': [[2017, 8]] },
        'references-count': 34,
        URL: 'http://doi.org/10.1097/TA.0000000000001546',
        relation: {},
        ISSN: ['2163-0755'],
        subject: ['Surgery', 'Critical Care and Intensive Care Medicine'],
        'container-title-short': 'Journal of Trauma and Acute Care Surgery',
    },
    '10.1097/TA.0000000000001530': {
        indexed: {
            'date-parts': [[2017, 6, 20]],
            'date-time': '2017-06-20T19:19:32Z',
            timestamp: 1497986372276,
        },
        'reference-count': 34,
        publisher: 'Ovid Technologies (Wolters Kluwer Health)',
        issue: '1',
        'content-domain': { domain: [], 'crossmark-restriction': false },
        'published-print': { 'date-parts': [[2017, 7]] },
        DOI: '10.1097/ta.0000000000001530',
        type: 'article-journal',
        created: {
            'date-parts': [[2017, 4, 28]],
            'date-time': '2017-04-28T12:39:00Z',
            timestamp: 1493383140000,
        },
        page: '11-18',
        source: 'Crossref',
        'is-referenced-by-count': 0,
        title:
            'Multicenter retrospective study of noncompressible torso hemorrhage',
        prefix: '10.1097',
        volume: '83',
        author: [
            { given: 'Ronald', family: 'Chang', affiliation: [] },
            { given: 'Erin E.', family: 'Fox', affiliation: [] },
            { given: 'Thomas J.', family: 'Greene', affiliation: [] },
            { given: 'Brian J.', family: 'Eastridge', affiliation: [] },
            { given: 'Ramyar', family: 'Gilani', affiliation: [] },
            { given: 'Kevin K.', family: 'Chung', affiliation: [] },
            { given: 'Stacia M.', family: 'DeSantis', affiliation: [] },
            { given: 'Joseph J.', family: 'DuBose', affiliation: [] },
            { given: 'Jeffrey S.', family: 'Tomasek', affiliation: [] },
            {
                suffix: 'Jr.',
                given: 'Gerald R.',
                family: 'Fortuna',
                affiliation: [],
            },
            { given: 'Valerie G.', family: 'Sams', affiliation: [] },
            { given: 'S. Rob', family: 'Todd', affiliation: [] },
            { given: 'Jeanette M.', family: 'Podbielski', affiliation: [] },
            { given: 'Charles E.', family: 'Wade', affiliation: [] },
            { given: 'John B.', family: 'Holcomb', affiliation: [] },
        ],
        member: '276',
        'container-title': 'Journal of Trauma and Acute Care Surgery',
        'original-title': [],
        deposited: {
            'date-parts': [[2017, 6, 20]],
            'date-time': '2017-06-20T18:51:42Z',
            timestamp: 1497984702000,
        },
        score: 1.0,
        subtitle: [
            ' Anatomic locations of bleeding and comparison of endovascular versus open approach',
        ],
        'short-title': [],
        issued: { 'date-parts': [[2017, 7]] },
        'references-count': 34,
        URL: 'http://doi.org/10.1097/TA.0000000000001530',
        relation: {},
        ISSN: ['2163-0755'],
        'container-title-short': 'Journal of Trauma and Acute Care Surgery',
    },
};

type DOIPayload = [CSL.Data[], string[]];

export async function getFromDOI(
    doiList: string[],
): Promise<[CSL.Data[], string[]]> {
    return new Promise<DOIPayload>(
        (resolve, reject): void => {
            let payload: DOIPayload;
            try {
                payload = doiList.reduce(
                    (prev, id): DOIPayload => {
                        if (id === 'REJECT') {
                            throw new Error('some error occurred');
                        }
                        return data[id]
                            ? [[...prev[0], data[id]], [...prev[1]]]
                            : [[...prev[0]], [...prev[1], id]];
                    },
                    <DOIPayload>[[], []],
                );
            } catch (e) {
                return reject(e);
            }
            resolve(payload);
        },
    );
}
